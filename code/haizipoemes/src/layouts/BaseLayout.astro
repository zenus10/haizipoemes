---
// Base Layout Component
// 基础布局 - 包含导航栏和全局样式

import Navbar from "../components/Navbar.astro";
import "../styles/global.css";

interface Props {
  title: string;
  description?: string;
  fullWidth?: boolean;
  currentPage?:
    | "home"
    | "poetry"
    | "timeline"
    | "knowledge"
    | "contact";
}

const { title, description = "海子的诗", currentPage = "home", fullWidth = false } = Astro.props;
---

<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Fonts -->
    <link
      href="https://api.fontshare.com/v2/css?f[]=satoshi@300,400,500,700&display=swap"
      rel="stylesheet"
    />

    <title>{title}</title>
  </head>
  <body>
    <Navbar currentPage={currentPage} />

    <div class="h-dvh flex justify-center pt-[--navHeight] overflow-hidden">
      <div class={`relative ${fullWidth ? '' : 'max-w-[70rem]'} w-full`}>
        <div class={`h-full flex flex-col overflow-y-auto ${fullWidth ? '' : 'px-4 sm:px-7 lg:px-10'}`}>
          <slot />
        </div>
        <!-- 返回顶部按钮（定位在主容器内） -->
        <button class="back-to-top" aria-label="返回顶部" title="返回顶部">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 19V5M5 12l7-7 7 7"/>
          </svg>
        </button>
      </div>
    </div>

    <script>
      const backToTopBtn = document.querySelector('.back-to-top');
      if (backToTopBtn) {
        const scrollEl = backToTopBtn.parentElement?.querySelector('.overflow-y-auto') || document.documentElement;

        scrollEl.addEventListener('scroll', () => {
          backToTopBtn.classList.toggle('visible', scrollEl.scrollTop > 300);
        }, { passive: true });

        backToTopBtn.addEventListener('click', () => {
          scrollEl.scrollTo({ top: 0, behavior: 'smooth' });
        });
      }
    </script>
  </body>
</html>
